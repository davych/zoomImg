"use strict";function zoomIndex(t,e){if(!t)throw new Error("need dom element");if(!e.srcImg)throw new Error("need srcImg");var i=this;return this.options=Object.assign({coverWidth:100,coverIndex:1e3,mapIndex:1e3,srcImg:""},e),t.onload=function(){i.init(t)},this}zoomIndex.prototype.init=function(t){return this.target=t,this.targetPosition={x:this.target.x,y:this.target.y},this.targetStyle={w:this.target.width,h:this.target.height},this.setCoverBox(),this.setMapBox(),this.setEventHandler(),this},zoomIndex.prototype.setCoverBox=function(){this.coverHeight=this.targetStyle.h*this.options.coverWidth/this.targetStyle.w,this.coverStyle={left:this.targetPosition.x+"px",top:this.targetPosition.y+"px",display:"none",width:this.options.coverWidth+"px",height:this.coverHeight+"px",pointerEvents:"none",backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAMAAABFaP0WAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAGUExURT1uzv///62t27cAAAACdFJOU/8A5bcwSgAAABBJREFUeNpiYGBkYGQECDAAAA0ABMZIs2EAAAAASUVORK5CYII=)",opacity:".5",zIndex:this.options.coverIndex,position:"fixed"},this.coverSpan=document.createElement("span"),document.body.append(this.coverSpan),this.setStyle(this.coverSpan,this.coverStyle)},zoomIndex.prototype.setMapBox=function(){this.mapStyle={left:this.targetPosition.x+this.targetStyle.w+20+"px",top:this.targetPosition.y+"px",display:"none",width:this.targetStyle.w+"px",height:this.targetStyle.h+"px",pointerEvents:"none",backgroundColor:"red",overflow:"hidden",zIndex:this.options.mapIndex,position:"fixed"},this.mapSpan=document.createElement("span"),document.body.append(this.mapSpan),this.setStyle(this.mapSpan,this.mapStyle),this.mapImg=document.createElement("img"),this.mapImg.setAttribute("src",this.options.srcImg),this.mapSpan.append(this.mapImg),this.imgStyle={position:"absolute",left:0,top:0},this.srcWidth=this.targetStyle.w*this.targetStyle.w/this.options.coverWidth,this.srcHeight=this.targetStyle.h*this.targetStyle.h/this.coverHeight,this.imgStyle.width=this.srcWidth+"px",this.imgStyle.height=this.srcHeight+"px",this.setStyle(this.mapImg,this.imgStyle)},zoomIndex.prototype.fresh=function(t){Object.assign(this.options,t)},zoomIndex.prototype.setEventHandler=function(){var h=this;this.target.onmousemove=function(t){h.mapImg.src=h.options.srcImg;var e=t.x-h.options.coverWidth/2,i=t.y-h.coverHeight/2;e<h.target.x&&(e=h.target.x),e>h.target.x+h.targetStyle.w-h.options.coverWidth&&(e=h.target.x+h.targetStyle.w-h.options.coverWidth),i<h.target.y&&(i=h.target.y),i>h.target.y+h.targetStyle.h-h.coverHeight&&(i=h.target.y+h.targetStyle.h-h.coverHeight),h.setStyle(h.coverSpan,{left:e+"px",top:i+"px",display:"inline-block"});var o=h.targetStyle.w/h.srcWidth,s=h.targetStyle.h/h.srcHeight,n=(e-h.target.x)/o,r=(i-h.target.y)/s;h.setStyle(h.mapImg,{left:-n+"px",top:-r+"px"}),h.setStyle(h.mapSpan,{top:h.target.y+"px",left:h.target.x+h.targetStyle.w+20+"px",display:"inline-block"})},this.target.onmouseout=function(t){h.setStyle(h.coverSpan,{display:"none"}),h.setStyle(h.mapSpan,{display:"none"})}},zoomIndex.prototype.setStyle=function(t,e){for(var i in e)t.style[i]=e[i]},"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=zoomIndex);